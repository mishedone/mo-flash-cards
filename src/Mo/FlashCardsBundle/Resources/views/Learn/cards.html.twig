{% extends 'MoFlashCardsBundle::layout.html.twig' %}

{% block title %}{{ 'learnCards.meta.title'|trans({'%deck%': deck.name}) }}{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div id="card-player-question" style="float: left;">{{ 'learnCards.message.loading'|trans }}</div>
            <button id="card-player-play-question" class="btn btn-default btn-xs">
                <span class="glyphicon glyphicon glyphicon-volume-up" aria-hidden="true"></span>
            </button>
            <input id="card-player-answer" type="text" class="form-control" placeholder="{{ 'learnCards.form.placeholder.answer'|trans }}">
            <button id="card-player-show-hint" class="btn btn-default btn-primary">{{ 'learnCards.action.hint'|trans }}</button>
            <div id="card-player-hint"></div>
            <a href="{{ path('mofc_learn_decks') }}" class="btn btn-default">{{ 'learnCards.action.back'|trans }}</a><br>
            <dl id="card-player-history" class="dl-horizontal"></dl>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {% javascripts 
        '@jquery_js'
        '@MoFlashCardsBundle/Resources/public/js/CardPlayer.js' %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
        
    <script>
        $(document).ready(function() {
            var player = new CardPlayer(jQuery, {
                finishMessage: '{{ 'learnCards.message.finish'|trans }}',
                historyTemplate: '<dt style="width: 300px;">{{ '{{' }}question{{ '}}' }}</dt><dd style="margin-left: 310px;">{{ '{{' }}answer{{ '}}' }}</dd>'
            });
            
            // add cards
            {% for card in deck.getCards %}
                {% if forward %}
                    player.addCard('{{ card.front }}', '{{ card.back }}', '{{ path('mofc_resource_text_to_speech', {'text': card.front}) }}');
                {% else %}
                    player.addCard('{{ card.back }}', '{{ card.front }}', '{{ path('mofc_resource_text_to_speech', {'text': card.back}) }}');
                {% endif %}
            {% endfor %}

            // start the player
            player.start();
        });
    </script>
{% endblock %}
